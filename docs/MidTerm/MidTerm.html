<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.533">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Microscale Weather and Climate - MidTerm</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Microscale Weather and Climate</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Lectures/index.html"> 
<span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Assignments/index.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Study_Questions/index.html"> 
<span class="menu-text">Study Questions</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/June-Skeeter"> <i class="bi bi-github" role="img" aria-label="Quarto GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">MidTerm</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="written-portion" class="level1">
<h1>Written Portion</h1>
<section id="problem-question" class="level2">
<h2 class="anchored" data-anchor-id="problem-question">Problem Question</h2>
<div class="cell" data-execution_count="1">
<div id="tbl-constants" class="cell quarto-float anchored" data-execution_count="1">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-constants-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Constants
</figcaption>
<div aria-describedby="tbl-constants-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="1">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Constant</th>
<th style="text-align: left;">Symbol</th>
<th style="text-align: right;">Value</th>
<th style="text-align: left;">Units</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Heat Capacity of Air</td>
<td style="text-align: left;"><span class="math inline">\(C_a\)</span></td>
<td style="text-align: right;">0.001</td>
<td style="text-align: left;"><span class="math inline">\(MJ m^{-3} K^{-1}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Heat Capacity of Water</td>
<td style="text-align: left;"><span class="math inline">\(C_w\)</span></td>
<td style="text-align: right;">4.2</td>
<td style="text-align: left;"><span class="math inline">\(MJ m^{-3} K^{-1}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Heat Capacity of Organic Soil</td>
<td style="text-align: left;"><span class="math inline">\(C_o\)</span></td>
<td style="text-align: right;">2.5</td>
<td style="text-align: left;"><span class="math inline">\(MJ m^{-3} K^{-1}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Heat Capacity of Mineral Soil</td>
<td style="text-align: left;"><span class="math inline">\(C_a\)</span></td>
<td style="text-align: right;">2</td>
<td style="text-align: left;"><span class="math inline">\(MJ m^{-3} K^{-1}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Solar Constant</td>
<td style="text-align: left;"><span class="math inline">\(I_0\)</span></td>
<td style="text-align: right;">1361</td>
<td style="text-align: left;"><span class="math inline">\(W m^{-2}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Latent Heat of Vaporization</td>
<td style="text-align: left;"><span class="math inline">\(L_v\)</span></td>
<td style="text-align: right;">2.5</td>
<td style="text-align: left;"><span class="math inline">\(MJ kg^{-1}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Latent Heat of Fusion</td>
<td style="text-align: left;"><span class="math inline">\(L_f\)</span></td>
<td style="text-align: right;">0.34</td>
<td style="text-align: left;"><span class="math inline">\(MJ kg^{-1}\)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-execution_count="2">
<div id="tbl-symbols" class="cell quarto-float anchored" data-execution_count="2">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-symbols-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Symbols
</figcaption>
<div aria-describedby="tbl-symbols-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="2">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Symbol</th>
<th style="text-align: left;">Name</th>
<th style="text-align: left;">Units</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(R_n\)</span></td>
<td style="text-align: left;">Net Radiation</td>
<td style="text-align: left;"><span class="math inline">\(W m^{-2}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(LE\)</span></td>
<td style="text-align: left;">Latent Heat Flux</td>
<td style="text-align: left;"><span class="math inline">\(W m^{-2}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(H\)</span></td>
<td style="text-align: left;">Sensible Heat Flux</td>
<td style="text-align: left;"><span class="math inline">\(W m^{-2}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(H_g\)</span></td>
<td style="text-align: left;">Ground Heat Flux</td>
<td style="text-align: left;"><span class="math inline">\(W m^{-2}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(Ta_z\)</span></td>
<td style="text-align: left;">Air Temperature at the Height (z in m) Above the Surface</td>
<td style="text-align: left;"><span class="math inline">\(^{\circ}C\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(RH_z\)</span></td>
<td style="text-align: left;">Relative Humidity at the Height (z in m) Above the Surface</td>
<td style="text-align: left;">%</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(T_0\)</span></td>
<td style="text-align: left;">Temperature at the Ground Surface</td>
<td style="text-align: left;"><span class="math inline">\(^{\circ}C\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(Ts_z\)</span></td>
<td style="text-align: left;">Air Temperature at the Depth (z in m) Below the Surface</td>
<td style="text-align: left;"><span class="math inline">\(^{\circ}C\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\Theta_o\)</span></td>
<td style="text-align: left;">Volumetric Fraction of Organic Matter</td>
<td style="text-align: left;">%</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\Theta_w\)</span></td>
<td style="text-align: left;">Volumetric Fraction of Liquid Fresh Water</td>
<td style="text-align: left;">%</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(r_b\)</span></td>
<td style="text-align: left;">Boundary Layer Resistance</td>
<td style="text-align: left;"><span class="math inline">\(s m^{-1}\)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>You have randomly been assigned observations of conditions above and below different the ground surface at a collection of different sites <a href="#tbl-data" class="quarto-xref">Table&nbsp;3</a>. Each set observation was taken at midnight in early winter, under partly cloudy skies with light winds. The observations were precede by a period of dry weather, such that there is no liquid or solid water present on or above the soil surface. You will use these data to answer the questions below.</p>
<div class="cell" data-execution_count="3">
<div id="tbl-data" class="cell quarto-float anchored" data-execution_count="3">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Observations
</figcaption>
<div aria-describedby="tbl-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="3">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: right;"><span class="math inline">\(R_n\)</span></th>
<th style="text-align: right;"><span class="math inline">\(LE\)</span></th>
<th style="text-align: right;"><span class="math inline">\(Ta_{0.1}\)</span></th>
<th style="text-align: right;"><span class="math inline">\(RH_{0.1}\)</span></th>
<th style="text-align: right;"><span class="math inline">\(T_0\)</span></th>
<th style="text-align: right;"><span class="math inline">\(Ts_{0.1}\)</span></th>
<th style="text-align: right;"><span class="math inline">\(\Theta_o\)</span></th>
<th style="text-align: right;">Porosity</th>
<th style="text-align: right;"><span class="math inline">\(\Theta_w\)</span></th>
<th style="text-align: right;"><span class="math inline">\(r_b\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">-48</td>
<td style="text-align: right;">-5</td>
<td style="text-align: right;">-0.9</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">52</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">-45</td>
<td style="text-align: right;">-4</td>
<td style="text-align: right;">-0.7</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">55</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C</td>
<td style="text-align: right;">-46</td>
<td style="text-align: right;">-4</td>
<td style="text-align: right;">-0.8</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">54</td>
</tr>
<tr class="even">
<td style="text-align: left;">D</td>
<td style="text-align: right;">-47</td>
<td style="text-align: right;">-4</td>
<td style="text-align: right;">-0.8</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">53</td>
</tr>
<tr class="odd">
<td style="text-align: left;">E</td>
<td style="text-align: right;">-49</td>
<td style="text-align: right;">-5</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">51</td>
</tr>
<tr class="even">
<td style="text-align: left;">F</td>
<td style="text-align: right;">-49</td>
<td style="text-align: right;">-5</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">51</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<ol class="example" type="1">
<li>Based on the observations, what phenomena do you anticipate might occur at the ground surface over the next few hours? <strong>1/6</strong></li>
</ol>
<ul>
<li><p>Surface (+ adjacent air/soil) will cool because <span class="math inline">\(R_n\)</span> is negative.</p></li>
<li><p>Dew/frost are are expected to occur. As surface T_0 is just above 0 and RH = 100, with negative LE, Dew is probable to occur at first, but may transition to frost as the surface cools more.</p>
<ul>
<li>Should mention possibility of frost for full marks</li>
</ul></li>
</ul>
<ol start="2" class="example" type="1">
<li>Assuming heat storage fluxes (<span class="math inline">\(\Delta S\)</span>) are negligible; calculate <span class="math inline">\(H\)</span> approximate <span class="math inline">\(H_g\)</span>. You can assume that the laminar boundary layer for each site is exactly 0.1m thick. <strong>1/4</strong></li>
</ol>
<div id="0b8e2462" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Ca <span class="op">=</span> Constants.loc[<span class="st">'Heat Capacity of Air'</span>,<span class="st">'value'</span>]</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>Profile[<span class="st">'H'</span>] <span class="op">=</span> Ca<span class="op">*</span><span class="fl">1e6</span><span class="op">*</span>(Profile[<span class="st">'$T_0$'</span>]<span class="op">-</span>Profile[<span class="st">'$Ta_</span><span class="sc">{0.1}</span><span class="st">$'</span>])<span class="op">/</span>Profile[<span class="st">'$r_b$'</span>]</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>Profile[<span class="st">'Hg'</span>] <span class="op">=</span> Profile[<span class="st">'$R_n$'</span>]<span class="op">-</span>Profile[<span class="st">'$LE$'</span>]<span class="op">-</span>Profile[<span class="st">'H'</span>]</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>Profile[[<span class="st">'H'</span>,<span class="st">'Hg'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">H</th>
<th data-quarto-table-cell-role="th">Hg</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">A</td>
<td>36.538462</td>
<td>-79.538462</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">B</td>
<td>34.545455</td>
<td>-75.545455</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C</td>
<td>33.333333</td>
<td>-75.333333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">D</td>
<td>35.849057</td>
<td>-78.849057</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">E</td>
<td>41.176471</td>
<td>-85.176471</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">F</td>
<td>45.098039</td>
<td>-89.098039</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ol start="3" class="example" type="1">
<li>Estimate thermal admittance (<span class="math inline">\(\mu\)</span>) of the soil surface and report any intermediary parameters you calculated to obtain these values. <strong>1/4</strong></li>
</ol>
<div id="64f572cb" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Ca <span class="op">=</span> Constants.loc[<span class="st">'Heat Capacity of Air'</span>,<span class="st">'value'</span>]</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>Cm <span class="op">=</span> Constants.loc[<span class="st">'Heat Capacity of Mineral Soil'</span>,<span class="st">'value'</span>]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>Co <span class="op">=</span> Constants.loc[<span class="st">'Heat Capacity of Organic Soil'</span>,<span class="st">'value'</span>]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>Cw <span class="op">=</span> Constants.loc[<span class="st">'Heat Capacity of Water'</span>,<span class="st">'value'</span>]</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>Profile[<span class="st">'k W m-1 K-1'</span>] <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">*</span>Profile[<span class="st">'Hg'</span>]<span class="op">*</span>(<span class="fl">.1</span>)<span class="op">/</span>(Profile[<span class="st">'$Ts_</span><span class="sc">{0.1}</span><span class="st">$'</span>]<span class="op">-</span>Profile[<span class="st">'$T_0$'</span>])</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>Profile[<span class="st">'C MJ m-3 K-1'</span>] <span class="op">=</span> (Profile[<span class="st">'$\Theta_o$'</span>]<span class="op">*</span>Co<span class="op">+</span>(<span class="dv">100</span><span class="op">-</span>Profile[<span class="st">'Porosity'</span>]<span class="op">-</span>Profile[<span class="st">'$\Theta_o$'</span>])<span class="op">*</span>Cm<span class="op">+</span>Profile[<span class="st">'$\Theta_w$'</span>]<span class="op">*</span>Cw<span class="op">+</span>(Profile[<span class="st">'Porosity'</span>]<span class="op">-</span>Profile[<span class="st">'$\Theta_w$'</span>])<span class="op">*</span>Ca)<span class="op">*</span><span class="fl">0.01</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>Profile[<span class="st">'mu kJ m-2 K-1 s-1/2'</span>] <span class="op">=</span> (Profile[<span class="st">'k W m-1 K-1'</span>]<span class="op">*</span>Profile[<span class="st">'C MJ m-3 K-1'</span>])<span class="op">**</span><span class="fl">.5</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>Profile[[<span class="st">'C MJ m-3 K-1'</span>,<span class="st">'k W m-1 K-1'</span>,<span class="st">'mu kJ m-2 K-1 s-1/2'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">C MJ m-3 K-1</th>
<th data-quarto-table-cell-role="th">k W m-1 K-1</th>
<th data-quarto-table-cell-role="th">mu kJ m-2 K-1 s-1/2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">A</td>
<td>2.20915</td>
<td>3.458194</td>
<td>2.763995</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">B</td>
<td>2.29015</td>
<td>4.196970</td>
<td>3.100273</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C</td>
<td>2.26315</td>
<td>3.424242</td>
<td>2.783806</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">D</td>
<td>2.23615</td>
<td>3.942453</td>
<td>2.969161</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">E</td>
<td>2.18215</td>
<td>4.258824</td>
<td>3.048506</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">F</td>
<td>2.18215</td>
<td>4.689370</td>
<td>3.198892</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ol start="4" class="example" type="1">
<li>On another day, the same initial conditions are observed at each of your sites: <span class="math inline">\(R_n = 0 W m^{-2}\)</span>, <span class="math inline">\(LE = 0 W m^{-2}\)</span>, and <span class="math inline">\(Ta_{0.1} = -1 ^{\circ}C\)</span>, <span class="math inline">\(T_0 = 1 ^{\circ}C\)</span>, and <span class="math inline">\(Ts_{0.1} = 2 ^{\circ}C\)</span>. While the thermal properties of the soils that you estimated in the previous question have not changed. You can assume that <span class="math inline">\(R_n\)</span>, <span class="math inline">\(LE\)</span>, and <span class="math inline">\(Ta_{0.1}\)</span> remain fixed at their initial values, but <span class="math inline">\(T_0\)</span> and <span class="math inline">\(Ts_{0.1}\)</span> will change. It begins to snow heavily for 6 hours, and at the end of the snow-storm all three sites have experienced some amount of snow accumulation. Assuming that no snow accumulated at each site until <span class="math inline">\(T_0 &lt; 0 ^{\circ}C\)</span> which site do you expect would have the most snow, and which would have the least snow at the end of the snow storm? Explain your reasoning. <em>Note</em> you are not expected to specify how much snow accumulation will occur, just rank the sites in relative terms. <strong>1/3</strong></li>
</ol>
<ul>
<li><p><span class="math inline">\(R_n\)</span> and <span class="math inline">\(LE\)</span> are zero. From the temperature gradients, we can assume <span class="math inline">\(H\)</span> will be positive slightly positive (soil surface losing heat to atmosphere) and <span class="math inline">\(H_g\)</span> will be negative soil at depth losing heat to soil surface. However, we can’t assume that <span class="math inline">\(0 = H+H_G\)</span> (same magnitude/opposite sign) in this case, because we have to account for another component of the energy balance, <span class="math inline">\(\Delta M\)</span>, that we did not have to think about in previously.</p>
<ul>
<li>Given the outlined assumption (snow won’t accumulate until <span class="math inline">\(T_0 &lt; 0 ^{\circ} C\)</span>) the first soil to have <span class="math inline">\(T_0\)</span> &lt; 0 will accumulate snow first. Until then, snow will melt on the grounds surface until <span class="math inline">\(T_0 &lt; 0 ^{\circ} C\)</span>. The process of melting will remove heat from the soil as well <span class="math inline">\(\Delta M &gt;0\)</span>; which means <span class="math inline">\(0 = H + H_G + \Delta_M\)</span>.</li>
</ul></li>
<li><p>Snowfall accumulation is expected to be inversely related to to thermal admittance <span class="math inline">\(\mu\)</span> because lower thermal admittance means surface cools rapidly (less heat transfer from depth).</p>
<ul>
<li>Thermal admittance does increase as a function of <span class="math inline">\(\Theta_w\)</span>, and the water input from melting will increase <span class="math inline">\(\mu\)</span> slightly. While the increase is not linear, since all soils have initial <span class="math inline">\(\Theta_w &gt; 0.15\)</span>, its close enough to linear that one could reasonably assume a linear relationship. The increases in <span class="math inline">\(\mu\)</span> wouldn’t be drastically different between soils anyway as they have fairly similar properties.</li>
<li>Since <span class="math inline">\(T_0\)</span> is quite close to 0 C to start, there isn’t much cooling that needs to be done before accumulation will occur. So its reasonable to just look at the starting values of <span class="math inline">\(\mu\)</span> and use those to guess the order of which will reach 0 C first.</li>
</ul></li>
</ul>
<div id="ff43d89e" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Ranked <span class="op">=</span> Profile.sort_values(by<span class="op">=</span><span class="st">'mu kJ m-2 K-1 s-1/2'</span>).reset_index()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  Ranked,headers<span class="op">=</span>Ranked.columns.values</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="6">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th></th>
<th style="text-align: left;">index</th>
<th style="text-align: left;">ID</th>
<th style="text-align: right;"><span class="math inline">\(R_n\)</span></th>
<th style="text-align: right;"><span class="math inline">\(LE\)</span></th>
<th style="text-align: right;"><span class="math inline">\(Ta_{0.1}\)</span></th>
<th style="text-align: right;"><span class="math inline">\(RH_{0.1}\)</span></th>
<th style="text-align: right;"><span class="math inline">\(T_0\)</span></th>
<th style="text-align: right;"><span class="math inline">\(Ts_{0.1}\)</span></th>
<th style="text-align: right;"><span class="math inline">\(\Theta_o\)</span></th>
<th style="text-align: right;">Porosity</th>
<th style="text-align: right;"><span class="math inline">\(\Theta_w\)</span></th>
<th style="text-align: right;"><span class="math inline">\(r_b\)</span></th>
<th style="text-align: right;">H</th>
<th style="text-align: right;">Hg</th>
<th style="text-align: right;">k W m-1 K-1</th>
<th style="text-align: right;">C MJ m-3 K-1</th>
<th style="text-align: right;">mu kJ m-2 K-1 s-1/2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">-48</td>
<td style="text-align: right;">-5</td>
<td style="text-align: right;">-0.9</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">36.5385</td>
<td style="text-align: right;">-79.5385</td>
<td style="text-align: right;">3.45819</td>
<td style="text-align: right;">2.20915</td>
<td style="text-align: right;">2.764</td>
</tr>
<tr class="even">
<td>1</td>
<td style="text-align: left;">C</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">-46</td>
<td style="text-align: right;">-4</td>
<td style="text-align: right;">-0.8</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">33.3333</td>
<td style="text-align: right;">-75.3333</td>
<td style="text-align: right;">3.42424</td>
<td style="text-align: right;">2.26315</td>
<td style="text-align: right;">2.78381</td>
</tr>
<tr class="odd">
<td>2</td>
<td style="text-align: left;">D</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">-47</td>
<td style="text-align: right;">-4</td>
<td style="text-align: right;">-0.8</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">35.8491</td>
<td style="text-align: right;">-78.8491</td>
<td style="text-align: right;">3.94245</td>
<td style="text-align: right;">2.23615</td>
<td style="text-align: right;">2.96916</td>
</tr>
<tr class="even">
<td>3</td>
<td style="text-align: left;">E</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">-49</td>
<td style="text-align: right;">-5</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">41.1765</td>
<td style="text-align: right;">-85.1765</td>
<td style="text-align: right;">4.25882</td>
<td style="text-align: right;">2.18215</td>
<td style="text-align: right;">3.04851</td>
</tr>
<tr class="odd">
<td>4</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">-45</td>
<td style="text-align: right;">-4</td>
<td style="text-align: right;">-0.7</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">34.5455</td>
<td style="text-align: right;">-75.5455</td>
<td style="text-align: right;">4.19697</td>
<td style="text-align: right;">2.29015</td>
<td style="text-align: right;">3.10027</td>
</tr>
<tr class="even">
<td>5</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">-49</td>
<td style="text-align: right;">-5</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">45.098</td>
<td style="text-align: right;">-89.098</td>
<td style="text-align: right;">4.68937</td>
<td style="text-align: right;">2.18215</td>
<td style="text-align: right;">3.19889</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="short-answers" class="level2">
<h2 class="anchored" data-anchor-id="short-answers">Short Answers</h2>
<ol start="5" class="example" type="1">
<li>Briefly describe two ways in which a soil temperature wave changes with depth as it moves down in response to radiate forcing at the surface. Which thermal property of soil that we discussed in lecture influences how the temperature wave will propagate through the soil? All else equal, what happens if this property decreases?</li>
</ol>
<ul>
<li>The changes are described by the equation on <a href="../Lectures/09.html#a-solution-of-fouriers-heat-conduction">this slide</a>
<ul>
<li>Attenuation/damping (reduction in amplitude) with increasing depth (<strong>1/3</strong>)</li>
<li>Phase shift (time offset) with increasing depth (<strong>1/3</strong>)</li>
</ul></li>
<li>Thermal <strong>diffusivity</strong> (<span class="math inline">\(K = \frac{k}{C}\)</span>) is the property that controls it (as per the equation). If K is higher &gt; phase shift and attenuation are reduced (reduced attenuation would mean damping depth increases) (<strong>1/3</strong>)
<ul>
<li>Thermal conductivity (<span class="math inline">\(k\)</span>) or heat capacity (<span class="math inline">\(C\)</span>) can be accepted (for partial marks). However <span class="math inline">\(K = \frac{k}{C}\)</span>, so its not strictly controlled by either</li>
</ul></li>
</ul>
<ol start="6" class="example" type="1">
<li>Briefly explain what factors influence net short-wave SW* and net long-wave LW* radiation at the earth’s surface?</li>
</ol>
<ul>
<li><a href="../Lectures/07.html#/component-fluxes">This slide</a> summarizes the important aspects:</li>
<li><span class="math inline">\(SW^*\)</span> depends on:
<ul>
<li><span class="math inline">\(SW\downarrow\)</span> &gt; influenced by sun earth geometry (distance from sun, solar declination); beam spreading (latitude, time of day, and slope, should mention of cosine law of attenuation for full credit), along with atmospheric scattering &amp; reflection (bulk transitivity). <strong>Only</strong> sourced from the Sun (<strong>1/4</strong>)</li>
<li><span class="math inline">\(SW\uparrow\)</span> &gt; determined by albedo &amp; magnitude of <span class="math inline">\(SW\downarrow\)</span>. Albedo is determined by surface properties (e.g., presence of snow, vegetation health, soil type/moisture, etc.) and varies by sun angle (albedo is higher for lower sun angles). For some “surfaces” (ice, water, etc.) it also depends on the transitivity of the volume. Surface can absorb <span class="math inline">\(SW\downarrow\)</span>, but <strong>cannot</strong> emit it! (<strong>1/4</strong>)</li>
</ul></li>
<li><span class="math inline">\(LW^*\)</span> depends on:
<ul>
<li><span class="math inline">\(LW\downarrow\)</span> &gt; determined by the temperature and emissivity <span class="math inline">\(\epsilon\)</span> of the atmosphere. Warmer atmosphere = higher LW emissions; more emissive atmosphere = higher LW emissions. Clouds are a good example: <span class="math inline">\(LW\downarrow\)</span> tends to be higher (for equivalent surface temps/seasons) when clouds are present (<strong>1/4</strong>)</li>
<li><span class="math inline">\(LW\uparrow\)</span> &gt; determined by the temperature, emissivity <span class="math inline">\(\epsilon\)</span>, and <strong>reflectivity</strong> of the surface. Warmer surface = higher LW emissions; more emissive surface = higher LW emissions. Should mention that <span class="math inline">\(\epsilon = \zeta\)</span> (absorptivity) in the <strong>long-wave</strong> portion of the spectrum (Khirchoff’s law). Also influenced by surface albedo (<span class="math inline">\(SW\)</span>): Lower albedo = higher SW absorption = warmer surface = higher LW emissions.(<strong>1/4</strong>)</li>
</ul></li>
</ul>
</section>
</section>
<section id="calculations" class="level1">
<h1>Calculations</h1>
<div id="9ec04ab1" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>seed <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(seed)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>epsilon <span class="op">=</span> np.<span class="bu">round</span>(np.random.rand(N)<span class="op">*</span><span class="fl">.075</span><span class="op">+</span><span class="fl">.9</span>,<span class="dv">3</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>np.random.seed(seed)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>LW <span class="op">=</span> np.<span class="bu">round</span>(np.random.rand(N)<span class="op">*</span><span class="dv">20</span><span class="op">+</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="7" class="example" type="1">
<li>Assuming that a surface has an emissivity (<span class="math inline">\(\epsilon_{o,LW}\)</span>) of array([0.928, 0.971, 0.955, 0.945]), how much of the incoming long-wave radiation <span class="math inline">\(LW\downarrow\)</span> is reflected from the surface when <span class="math inline">\(LW\downarrow\)</span> is array([107., 119., 115., 112.]) <span class="math inline">\(W m^{-2}\)</span>?</li>
</ol>
<div id="e3507913" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>epsilon</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>a </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'alpha = '</span>, alpha)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'LW_reflected = '</span>,LW<span class="op">*</span>alpha)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>alpha =  [0.072 0.029 0.045 0.055]
LW_reflected =  [7.704 3.451 5.175 6.16 ]</code></pre>
</div>
</div>
<div id="fa5750e1" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Dates <span class="op">=</span> pd.DatetimeIndex([<span class="st">'2024-12-15'</span>,<span class="st">'2024-03-31'</span>,<span class="st">'2024-07-20'</span>,<span class="st">'2024-10-01'</span>])</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>Psi_a <span class="op">=</span> np.array([<span class="fl">0.85</span>,<span class="fl">0.7</span>,<span class="fl">0.65</span>,<span class="fl">0.8</span>])</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>np.random.seed(seed)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>Lat <span class="op">=</span> np.array([np.random.randint(<span class="dv">20</span>,<span class="dv">80</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">4</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="8" class="example" type="1">
<li>At Local solar noon (LAT = 12:00) on DatetimeIndex([‘2024-12-15’, ‘2024-03-31’, ‘2024-07-20’, ‘2024-10-01’], dtype=‘datetime64[ns]’, freq=None) at array([58, 71, 48, 34]) <span class="math inline">\(^{\circ}\)</span> N, <span class="math inline">\(\Psi_a\)</span> = array([0.85, 0.7 , 0.65, 0.8 ]). Estimate <span class="math inline">\(SW\downarrow\)</span></li>
</ol>
<div id="e835ec99" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Extraterrestrial_Irradiance(DOY,Lat):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    I0 <span class="op">=</span> <span class="dv">1361</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    gamma <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>np.pi<span class="op">/</span><span class="dv">365</span><span class="op">*</span>(DOY<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'gamma '</span>,gamma)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> <span class="fl">0.006918</span> <span class="op">-</span> <span class="fl">0.399912</span> <span class="op">*</span> np.cos(gamma)<span class="op">+</span><span class="fl">0.070257</span> <span class="op">*</span>np.sin(gamma)<span class="op">-</span><span class="fl">0.006758</span> <span class="op">*</span>np.cos(<span class="dv">2</span><span class="op">*</span>gamma) <span class="op">+</span> <span class="fl">0.000907</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>gamma)<span class="op">-</span><span class="fl">0.002697</span><span class="op">*</span>np.cos(<span class="dv">3</span><span class="op">*</span>gamma)<span class="op">+</span><span class="fl">0.00148</span> <span class="op">*</span>np.sin(<span class="dv">3</span><span class="op">*</span>gamma)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'delta = '</span>,delta)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'delta deg = '</span>,delta<span class="op">*</span><span class="dv">180</span><span class="op">/</span>np.pi)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    Z <span class="op">=</span> np.arccos(np.sin(Lat<span class="op">*</span>np.pi<span class="op">/</span><span class="dv">180</span>)<span class="op">*</span>np.sin(delta)<span class="op">+</span>np.cos(Lat<span class="op">*</span>np.pi<span class="op">/</span><span class="dv">180</span>)<span class="op">*</span>np.cos(delta))<span class="op">*</span><span class="dv">180</span><span class="op">/</span>np.pi</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'z = '</span>,Z)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    R_av_Rsq <span class="op">=</span> <span class="fl">1.00011</span><span class="op">+</span><span class="fl">0.034221</span><span class="op">*</span>np.cos(gamma)<span class="op">+</span><span class="fl">0.001280</span><span class="op">*</span>np.sin(gamma)<span class="op">+</span><span class="fl">0.000819</span><span class="op">*</span>np.cos(<span class="dv">2</span><span class="op">*</span>gamma)<span class="op">+</span><span class="fl">0.000077</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>gamma)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'R_av_Rsq = '</span>,R_av_Rsq)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    I_ex<span class="op">=</span>I0<span class="op">*</span>R_av_Rsq<span class="op">*</span>np.cos(Z<span class="op">*</span>np.pi<span class="op">/</span><span class="dv">180</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'I_ex = '</span>,I_ex)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(delta,Z,I_ex)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'DOY:'</span>,Dates.dayofyear.values)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>delta,Z,I_ex <span class="op">=</span> Extraterrestrial_Irradiance(Dates.dayofyear.values,Lat)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>SW <span class="op">=</span> I_ex<span class="op">*</span>Psi_a<span class="op">**</span>(<span class="dv">1</span><span class="op">/</span>np.cos(Z<span class="op">*</span>np.pi<span class="op">/</span><span class="dv">180</span>))</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'SW incoming '</span>,np.<span class="bu">round</span>(SW,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DOY: [350  91 202 275]
gamma  [6.00775801 1.54927857 3.46005547 4.71669253]
delta =  [-0.40617693  0.07404202  0.36017855 -0.05679475]
delta deg =  [-23.27222406   4.24229502  20.63671088  -3.25409931]
z =  [81.27222406 66.75770498 27.36328912 37.25409931]
R_av_Rsq =  [1.03335062 1.00131108 0.96791314 0.99815765]
I_ex =  [ 213.4056567   537.78237427 1169.93383892 1081.30396588]
SW incoming  [ 73.12 217.81 720.28 816.95]</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>